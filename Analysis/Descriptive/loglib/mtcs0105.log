-----------------------------------------------------------------------------------------------------------------------------------------------------------------       log:  /Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/loglib/mtcs0105.log  log type:  text opened on:   8 Mar 2011, 21:10:09. . . clear. set mem 300m(307200k). use "/Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/datlib/lubin_ind", replace. . merge smid using "/Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/datlib/lubin_exp", sort uniqmastervariable smid does not uniquely identify observations in /var/folders/UD/UDncDfgxGjiUYz2ZUklYTU+++TI/-Tmp-//S_00475.00000w. .         drop if age < age_entry | age > age_exit(368987 observations deleted). . /*Parametric G-formula steps: >  1-resample data B times, each size N, and append to observed data of size N>  2-fit models to observed data and resamples and get estimated parameters/variance>  3-generate K monte-carlo samples each of size M using parameters/variance estimated from data/resamples>  4-PE from observed data and SE as STD of the B bootstrap resamples;> > > *** 1-resample data B times, each size N, and append to observed data of size N;*/. . . * person year data. .         gen yearon=1. .         sort smid age.         *years on study variable.         by smid: replace yearon = sum(yearon)(256105 real changes made). .         * last year variable    .         by smid: egen stop = max(yearon).         .         * event indicator.         gen birthy = year(dob).         gen event = 0.         by smid: replace event =1 if _n == _N & died == 1(4930 real changes made).         .         list smid yearon stop died event birthy d_lubin in 1/50     +--------------------------------------------------------+     | smid   yearon   stop   died   event   birthy   d_lubin |     |--------------------------------------------------------|  1. |    1        1      9      1       0     1869   15.6426 |  2. |    1        2      9      1       0     1869   15.9326 |  3. |    1        3      9      1       0     1869   16.1588 |  4. |    1        4      9      1       0     1869   16.4488 |  5. |    1        5      9      1       0     1869   16.7388 |     |--------------------------------------------------------|  6. |    1        6      9      1       0     1869   17.0288 |  7. |    1        7      9      1       0     1869   17.2521 |  8. |    1        8      9      1       0     1869   17.2521 |  9. |    1        9      9      1       1     1869   17.2521 | 10. |    2        1      4      1       0     1858   21.3672 |     |--------------------------------------------------------| 11. |    2        2      4      1       0     1858   21.6572 | 12. |    2        3      4      1       0     1858   21.9037 | 13. |    2        4      4      1       1     1858   21.9037 | 14. |    3        1      9      1       0     1858    29.783 | 15. |    3        2      9      1       0     1858    30.363 |     |--------------------------------------------------------| 16. |    3        3      9      1       0     1858   30.7632 | 17. |    3        4      9      1       0     1858   30.7632 | 18. |    3        5      9      1       0     1858   30.7632 | 19. |    3        6      9      1       0     1858   30.7632 | 20. |    3        7      9      1       0     1858   30.7632 |     |--------------------------------------------------------| 21. |    3        8      9      1       0     1858   30.7632 | 22. |    3        9      9      1       1     1858   30.7632 | 23. |    4        1      3      1       0     1872    14.268 | 24. |    4        2      3      1       0     1872    14.558 | 25. |    4        3      3      1       1     1872   14.7088 |     |--------------------------------------------------------| 26. |    5        1     15      1       0     1864   17.2057 | 27. |    5        2     15      1       0     1864   17.4957 | 28. |    5        3     15      1       0     1864   17.7857 | 29. |    5        4     15      1       0     1864   18.0757 | 30. |    5        5     15      1       0     1864   18.3657 |     |--------------------------------------------------------| 31. |    5        6     15      1       0     1864   18.6557 | 32. |    5        7     15      1       0     1864    18.879 | 33. |    5        8     15      1       0     1864    18.879 | 34. |    5        9     15      1       0     1864    18.879 | 35. |    5       10     15      1       0     1864    18.879 |     |--------------------------------------------------------| 36. |    5       11     15      1       0     1864    18.879 | 37. |    5       12     15      1       0     1864    18.879 | 38. |    5       13     15      1       0     1864    18.879 | 39. |    5       14     15      1       0     1864    18.879 | 40. |    5       15     15      1       1     1864    18.879 |     |--------------------------------------------------------| 41. |    6        1      9      1       0     1864   14.6392 | 42. |    6        2      9      1       0     1864   14.9292 | 43. |    6        3      9      1       0     1864   15.2192 | 44. |    6        4      9      1       0     1864   15.5092 | 45. |    6        5      9      1       0     1864   15.6426 |     |--------------------------------------------------------| 46. |    6        6      9      1       0     1864   15.6426 | 47. |    6        7      9      1       0     1864   15.6426 | 48. |    6        8      9      1       0     1864   15.6426 | 49. |    6        9      9      1       1     1864   15.6426 | 50. |    7        1     12      1       0     1862    20.329 |     +--------------------------------------------------------+.         .         .         sort smid age. .         *yearly exposure data - doesn't seem to work this way.         gen exp = 0.         gen prevexp = 0 .         by smid: replace exp = d_lubin if _n == 1(7802 real changes made).         by smid: replace prevexp = d_lubin if _n == 1(7802 real changes made).         by smid: replace prevexp = d_lubin[_n-1] if _n>1(254057 real changes made).         by smid: replace exp = d_lubin-prevexp if _n > 1(80538 real changes made).         .         list smid age* year* exp prevexp d_lubin in 10000/10050       +----------------------------------------------------------------------------+       | smid   age_en~y   age_exit   age   yearon        exp    prevexp    d_lubin |       |----------------------------------------------------------------------------|10000. |  603         42         74    57       16   .5799999    19.6736    20.2536 |10001. |  603         42         74    58       17   .5799999    20.2536    20.8336 |10002. |  603         42         74    59       18       .493    20.8336    21.3266 |10003. |  603         42         74    60       19   .5800018    21.3266    21.9066 |10004. |  603         42         74    61       20   .4175987    21.9066    22.3242 |       |----------------------------------------------------------------------------|10005. |  603         42         74    62       21   .5799999    22.3242    22.9042 |10006. |  603         42         74    63       22   .5799999    22.9042    23.4842 |10007. |  603         42         74    64       23   .5568008    23.4842     24.041 |10008. |  603         42         74    65       24   .2667999     24.041    24.3078 |10009. |  603         42         74    66       25          0    24.3078    24.3078 |       |----------------------------------------------------------------------------|10010. |  603         42         74    67       26          0    24.3078    24.3078 |10011. |  603         42         74    68       27          0    24.3078    24.3078 |10012. |  603         42         74    69       28          0    24.3078    24.3078 |10013. |  603         42         74    70       29          0    24.3078    24.3078 |10014. |  603         42         74    71       30          0    24.3078    24.3078 |       |----------------------------------------------------------------------------|10015. |  603         42         74    72       31          0    24.3078    24.3078 |10016. |  603         42         74    73       32          0    24.3078    24.3078 |10017. |  603         42         74    74       33          0    24.3078    24.3078 |10018. |  604         52         69    52        1   245.8476   245.8476   245.8476 |10019. |  604         52         69    53        2   11.30002   245.8476   257.1476 |       |----------------------------------------------------------------------------|10020. |  604         52         69    54        3   11.29999   257.1476   268.4476 |10021. |  604         52         69    55        4   11.29999   268.4476   279.7476 |10022. |  604         52         69    56        5   11.30002   279.7476   291.0476 |10023. |  604         52         69    57        6   11.29999   291.0476   302.3476 |10024. |  604         52         69    58        7   11.30002   302.3476   313.6476 |       |----------------------------------------------------------------------------|10025. |  604         52         69    59        8   11.29999   313.6476   324.9476 |10026. |  604         52         69    60        9   10.62201   324.9476   335.5696 |10027. |  604         52         69    61       10   10.62198   335.5696   346.1916 |10028. |  604         52         69    62       11   10.84802   346.1916   357.0396 |10029. |  604         52         69    63       12   11.29999   357.0396   368.3396 |       |----------------------------------------------------------------------------|10030. |  604         52         69    64       13   11.29999   368.3396   379.6396 |10031. |  604         52         69    65       14   11.30002   379.6396   390.9396 |10032. |  604         52         69    66       15   11.29999   390.9396   402.2396 |10033. |  604         52         69    67       16   11.30002   402.2396   413.5396 |10034. |  604         52         69    68       17   11.29999   413.5396   424.8396 |       |----------------------------------------------------------------------------|10035. |  604         52         69    69       18   1.130005   424.8396   425.9696 |10036. |  605         50         57    50        1     12.296     12.296     12.296 |10037. |  605         50         57    51        2   .5800009     12.296     12.876 |10038. |  605         50         57    52        3   .5799999     12.876     13.456 |10039. |  605         50         57    53        4   .5799999     13.456     14.036 |       |----------------------------------------------------------------------------|10040. |  605         50         57    54        5   .5799999     14.036     14.616 |10041. |  605         50         57    55        6   .5799999     14.616     15.196 |10042. |  605         50         57    56        7   .4233999     15.196    15.6194 |10043. |  605         50         57    57        8          0    15.6194    15.6194 |10044. |  606         53         63    53        1    12.4874    12.4874    12.4874 |       |----------------------------------------------------------------------------|10045. |  606         53         63    54        2   .5799999    12.4874    13.0674 |10046. |  606         53         63    55        3   .5799999    13.0674    13.6474 |10047. |  606         53         63    56        4   .5191002    13.6474    14.1665 |10048. |  606         53         63    57        5        .29    14.1665    14.4565 |10049. |  606         53         63    58        6        .29    14.4565    14.7465 |       |----------------------------------------------------------------------------|10050. |  606         53         63    59        7        .29    14.7465    15.0365 |       +----------------------------------------------------------------------------+.         .         .         preserve.                 gen i = smid.                 gen t = yearon.                 gen w = stop.                 gen x = exp.                 gen y = died.                 gen z = 1.                 .                 keep i t w x y age birthy z.                 .                 sort i t.                 tempfile a.                 save "`a'"file /var/folders/UD/UDncDfgxGjiUYz2ZUklYTU+++TI/-Tmp-//S_00475.000011 saved.                 .                 * keep first id for sampling.                 by i: keep if _n==1(256105 observations deleted).                 tempfile i.                 save `i'file /var/folders/UD/UDncDfgxGjiUYz2ZUklYTU+++TI/-Tmp-//S_00475.000012 saved.                 .                 set seed 339487731.                 bsample 8014.                 gen rep = 1.                 .                 su i    Variable |       Obs        Mean    Std. Dev.       Min        Max-------------+--------------------------------------------------------           i |      8014    7667.714    6215.147          1      21268.                 use `i', replace.                 .                 bsample 8014.                 gen rep = 2.                 .                 su i    Variable |       Obs        Mean    Std. Dev.       Min        Max-------------+--------------------------------------------------------           i |      8014    7700.709    6230.012          6      22092.         restore.         . * resample. .         . log close       log:  /Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/loglib/mtcs0105.log  log type:  text closed on:   8 Mar 2011, 21:10:11-----------------------------------------------------------------------------------------------------------------------------------------------------------------