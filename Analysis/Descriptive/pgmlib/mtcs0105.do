* corresponds to step3.sas from karminder* ignore this for nowlog using "/Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/loglib/mtcs0105.log", replace textclearset mem 300muse "/Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/datlib/lubin_ind", replacemerge smid using "/Users/akeil/School/Outside Projects/CopperArsenic/Descriptive/datlib/lubin_exp", sort uniqmaster	drop if age < age_entry | age > age_exit/*Parametric G-formula steps:  1-resample data B times, each size N, and append to observed data of size N 2-fit models to observed data and resamples and get estimated parameters/variance 3-generate K monte-carlo samples each of size M using parameters/variance estimated from data/resamples 4-PE from observed data and SE as STD of the B bootstrap resamples;*** 1-resample data B times, each size N, and append to observed data of size N;*/* person year data	gen yearon=1	sort smid age	*years on study variable	by smid: replace yearon = sum(yearon)	* last year variable		by smid: egen stop = max(yearon)		* event indicator	gen birthy = year(dob)	gen event = 0	by smid: replace event =1 if _n == _N & died == 1		list smid yearon stop died event birthy d_lubin in 1/50			sort smid age	*yearly exposure data - doesn't seem to work this way	gen exp = 0	gen prevexp = 0 	by smid: replace exp = d_lubin if _n == 1	by smid: replace prevexp = d_lubin if _n == 1	by smid: replace prevexp = d_lubin[_n-1] if _n>1	by smid: replace exp = d_lubin-prevexp if _n > 1		list smid age* year* exp prevexp d_lubin in 10000/10050			preserve		gen i = smid		gen t = yearon		gen w = stop		gen x = exp		gen y = died		gen z = 1				keep i t w x y age birthy z				sort i t		tempfile a		save "`a'"				* keep first id for sampling		by i: keep if _n==1		tempfile i		save `i'				set seed 339487731		bsample 8014		gen rep = 1				su i		use `i', replace				bsample 8014		gen rep = 2				su i	restore	* resample	log close